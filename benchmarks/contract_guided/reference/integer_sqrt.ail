module benchmarks/contract_guided/reference/integer_sqrt

-- Non-recursive integer square root via if/else chain.
-- Bounded to n <= 225 (sqrt = 15 max) to keep it verifiable by Z3.
-- For the benchmark, LLMs are free to use recursion (tested at runtime).
export pure func isqrt(n: int) -> int
  requires { n >= 0, n <= 225 }
  ensures { result >= 0, result * result <= n, (result + 1) * (result + 1) >= n + 1 }
{
  if n < 1 then 0
  else if n < 4 then 1
  else if n < 9 then 2
  else if n < 16 then 3
  else if n < 25 then 4
  else if n < 36 then 5
  else if n < 49 then 6
  else if n < 64 then 7
  else if n < 81 then 8
  else if n < 100 then 9
  else if n < 121 then 10
  else if n < 144 then 11
  else if n < 169 then 12
  else if n < 196 then 13
  else if n < 225 then 14
  else 15
}

export func main() -> () ! {IO} {
  println(show(isqrt(0)));
  println(show(isqrt(1)));
  println(show(isqrt(4)));
  println(show(isqrt(10)));
  println(show(isqrt(100)))
}
